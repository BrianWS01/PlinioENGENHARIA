<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#02093f">
    <meta name="msapplication-TileColor" content="#02093f">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Loja USETRAFO - Compre transformadores elétricos de alta qualidade. Transformadores isoladores e autotransformadores com garantia de 36 meses.">
    <meta name="keywords" content="loja transformadores, comprar transformadores, transformadores elétricos, USETRAFO loja">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://usetrafo.com.br/loja.html">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://usetrafo.com.br/loja.html">
    <meta property="og:title" content="Loja USETRAFO - Transformadores Elétricos">
    <meta property="og:description" content="Compre transformadores elétricos de alta qualidade com garantia de 36 meses.">
    <meta property="og:image" content="https://usetrafo.com.br/src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Loja USETRAFO - Transformadores Elétricos">
    <meta name="twitter:description" content="Compre transformadores elétricos de alta qualidade com garantia de 36 meses.">
    
    <title>Loja USETRAFO - Transformadores Elétricos | Compre Online</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" sizes="any" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="shortcut icon" type="image/svg+xml" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="152x152" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="144x144" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="120x120" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="114x114" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="76x76" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="72x72" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="60x60" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="apple-touch-icon" sizes="57x57" href="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg">
    <link rel="manifest" href="site.webmanifest">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- jsPDF para geração de PDFs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Gerador de Orçamento -->
    <script src="gerador-orcamento.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* Garantir que não haja hero ou área azul na loja */
        body {
            background: #ffffff !important;
        }
        
        /* Estilos específicos da loja */
        .product-image-hover {
            transition: transform 0.3s ease;
        }
        
        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2, 9, 63, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none; /* Não bloquear cliques */
            z-index: 1;
        }
        
        .position-relative:hover .product-overlay {
            opacity: 1;
        }
        
        .product-card a {
            position: relative;
            z-index: 2;
            display: block;
        }
        
        .product-card .card-body a {
            position: relative;
            z-index: 2;
        }
        
        .position-relative:hover .product-image-hover {
            transform: scale(1.1);
        }
        
        .product-card {
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(2, 9, 63, 0.2);
        }
        
        .product-card .card-img-top {
            height: 250px;
            object-fit: contain;
            background: #f8f9fa;
            padding: 20px;
        }
        
        .carrinho-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: #ffffff;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1050;
            transition: right 0.3s ease;
            overflow-y: auto;
        }
        
        .carrinho-sidebar.active {
            right: 0;
        }
        
        .carrinho-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1040;
            display: none;
        }
        
        .carrinho-overlay.active {
            display: block;
        }
        
        .carrinho-item {
            border-bottom: 1px solid #e9ecef;
            padding: 1rem 0;
        }
        
        .carrinho-item:last-child {
            border-bottom: none;
        }
        
        #btnCarrinho {
            padding: 0.5rem 0.75rem !important;
            min-width: 45px;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible !important;
        }
        
        #btnCarrinho i {
            font-size: 1.1rem;
            display: block;
        }
        
        .carrinho-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            z-index: 10;
        }
        
        @media (max-width: 768px) {
            .carrinho-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .product-card .card-img-top {
                height: 200px;
            }
            
            .loja-section {
                padding-top: 1rem !important;
            }
            
        .filter-btn {
            font-size: 0.85rem;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }
        
        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .filter-btn.active {
            box-shadow: 0 2px 8px rgba(2, 9, 63, 0.3);
        }
        
        .no-results {
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .loja-item {
            transition: all 0.3s ease;
        }
        
        .loja-item.d-none {
            display: none !important;
        }
        
        /* Melhorias nos filtros */
        .filter-count {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
        }
        
        .filter-btn.active .filter-count {
            background-color: rgba(255, 255, 255, 0.3) !important;
        }
        
        #contadorResultados {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .filter-btn {
            white-space: nowrap;
        }
        
        @media (max-width: 992px) {
            .filter-btn {
                font-size: 0.85rem;
                padding: 0.5rem 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .filter-btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            .filter-count {
                font-size: 0.7rem;
                padding: 0.2rem 0.4rem;
            }
            
        }
        
        @media (max-width: 576px) {
            .filter-btn {
                font-size: 0.75rem;
                padding: 0.35rem 0.7rem;
            }
            
            .filter-btn i {
                margin-right: 0.25rem !important;
            }
            
            .filter-count {
                font-size: 0.65rem;
                padding: 0.15rem 0.3rem;
                margin-left: 0.25rem !important;
            }
        }
        }
        
        @media (max-width: 576px) {
            .product-card .card-img-top {
                height: 180px;
            }
            
            .filter-btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
        }

        /* Estilos da Calculadora */
        #calculadoraContainer {
            transition: all 0.3s ease;
        }

        /* Remover hover do card principal da calculadora */
        .card.shadow-sm.border-0:has(#calculadoraContainer) {
            transition: none;
        }

        .card.shadow-sm.border-0:has(#calculadoraContainer):hover {
            transform: none;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075) !important;
        }

        #calculadoraContainer .card {
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        #calculadoraContainer .form-control:focus,
        #calculadoraContainer .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(2, 9, 63, 0.25);
        }

        /* Estilos das Abas */
        #calculadoraTabs .nav-link {
            color: #212529;
            border: 2px solid #dee2e6;
            border-radius: 0.375rem 0.375rem 0 0;
            background-color: #ffffff;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        #calculadoraTabs .nav-link:hover {
            color: var(--primary-color);
            background-color: #f8f9fa;
            border-color: #dee2e6;
        }

        #calculadoraTabs .nav-link.active {
            color: var(--primary-color);
            background-color: #ffffff;
            border-color: var(--primary-color);
            border-bottom-color: #ffffff;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        #calculadoraTabs .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #ffffff;
        }

        #calculadoraTabs .nav-link i {
            margin-right: 0.5rem;
        }

        .tab-content {
            padding-top: 1.5rem;
        }

        .tab-pane .table {
            margin-bottom: 0;
        }

        .tab-pane .table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            border-color: var(--primary-color);
        }

        .tab-pane .table-success {
            background-color: rgba(40, 167, 69, 0.1);
        }

        .tab-pane .bg-light {
            background-color: #f8f9fa !important;
        }

        @media (max-width: 768px) {
            #calculadoraContainer .row.g-4 > div {
                margin-bottom: 1rem;
            }

            #calculadoraTabs .nav-link {
                font-size: 0.85rem;
                padding: 0.5rem 0.75rem;
            }

            #calculadoraTabs .nav-link i {
                display: none;
            }
        }

        @media (max-width: 576px) {
            #calculadoraTabs {
                flex-wrap: wrap;
            }

            #calculadoraTabs .nav-item {
                flex: 0 0 50%;
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg" alt="USETRAFO - Transformadores Elétricos" class="img-fluid" loading="eager">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation menu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#sobre">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="orcamento-personalizado.html">Orçamento Personalizado</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="loja.html">Loja</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="calculadora.html">Calculadora</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#contato">Contato</a>
                    </li>
                    <li class="nav-item">
                        <div class="dropdown me-2">
                            <button class="btn btn-outline-primary dropdown-toggle" type="button" id="userMenuDropdown" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Menu do usuário">
                                <i class="fas fa-user" aria-hidden="true"></i>
                                <span class="d-none d-md-inline ms-2" id="userNameDisplay">Conta</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuDropdown" id="userMenu">
                                <li id="menuItemLogin" style="display: none;">
                                    <a class="dropdown-item" href="login.html">
                                        <i class="fas fa-sign-in-alt me-2"></i>Entrar
                                    </a>
                                </li>
                                <li id="menuItemRegister" style="display: none;">
                                    <a class="dropdown-item" href="registro.html">
                                        <i class="fas fa-user-plus me-2"></i>Criar Conta
                                    </a>
                                </li>
                                <li id="menuItemConfig" style="display: none;">
                                    <a class="dropdown-item" href="configuracoes.html">
                                        <i class="fas fa-cog me-2"></i>Configurações
                                    </a>
                                </li>
                                <li id="menuItemLogout" style="display: none;">
                                    <hr class="dropdown-divider">
                                    <a class="dropdown-item text-danger" href="#" id="btnLogout">
                                        <i class="fas fa-sign-out-alt me-2"></i>Sair
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-primary position-relative" id="btnCarrinho" type="button" aria-label="Abrir carrinho de compras" aria-describedby="carrinhoBadge">
                            <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                            <span class="carrinho-badge" id="carrinhoBadge" role="status" aria-live="polite">0</span>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Marquee de Destaques -->
    <div class="product-marquee">
        <div class="marquee-wrapper">
            <div class="marquee-content">
                <div class="marquee-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>36 Meses de Garantia Total</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-certificate"></i>
                    <span>Certificado ABNT/NBR</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-truck"></i>
                    <span>Entrega Rápida em Todo Brasil</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-flask"></i>
                    <span>Testes Individuais em Laboratório</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-award"></i>
                    <span>Mais de 30 Anos de Experiência</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-check-circle"></i>
                    <span>Qualidade Garantida</span>
                </div>
            </div>
            <div class="marquee-content" aria-hidden="true">
                <div class="marquee-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>36 Meses de Garantia Total</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-certificate"></i>
                    <span>Certificado ABNT/NBR</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-truck"></i>
                    <span>Entrega Rápida em Todo Brasil</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-flask"></i>
                    <span>Testes Individuais em Laboratório</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-award"></i>
                    <span>Mais de 30 Anos de Experiência</span>
                </div>
                <div class="marquee-separator"></div>
                <div class="marquee-item">
                    <i class="fas fa-check-circle"></i>
                    <span>Qualidade Garantida</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay do Carrinho -->
    <div class="carrinho-overlay" id="carrinhoOverlay"></div>

    <!-- Sidebar do Carrinho -->
    <div class="carrinho-sidebar" id="carrinhoSidebar">
        <div class="p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h5 class="mb-0 fw-bold">Carrinho de Compras</h5>
                <button class="btn-close" id="btnFecharCarrinho"></button>
            </div>
            <div id="carrinhoItens">
                <p class="text-muted text-center">Seu carrinho está vazio</p>
            </div>
            <div class="mt-auto pt-4 border-top">
                <div class="d-flex justify-content-between mb-3">
                    <strong>Total:</strong>
                    <strong id="carrinhoTotal">R$ 0,00</strong>
                </div>
                <button class="btn btn-primary w-100 mb-2" id="btnFinalizarCompra">
                    <i class="fas fa-check me-2"></i> Finalizar Compra
                </button>
                <button class="btn btn-outline-secondary w-100" id="btnLimparCarrinho">
                    <i class="fas fa-trash me-2"></i> Limpar Carrinho
                </button>
            </div>
        </div>
    </div>

    <!-- Loja Section -->
    <section class="py-5 loja-section" style="padding-top: 2rem !important;">
        <div class="container">
            <div class="text-center mb-5">
                <div class="loja-icon-header mb-3">
                    <i class="fas fa-store"></i>
                </div>
                <h1 class="display-4 fw-bold mb-3">Nossa Loja</h1>
                <p class="lead text-muted">Compre nossos produtos diretamente pela nossa loja online</p>
            </div>

            <!-- Card Orçamento Personalizado -->
            <div class="row mb-4">
                <div class="col-12 text-center">
                    <div class="card shadow-sm border-0" style="background: linear-gradient(135deg, var(--primary-color) 0%, #030d5a 100%);">
                        <div class="card-body p-4">
                            <i class="fas fa-tools fa-3x text-white mb-3"></i>
                            <h3 class="text-white mb-2">Não achou o que precisa?</h3>
                            <p class="text-white-50 mb-3">Faça seu próprio transformador personalizado sob medida para suas necessidades</p>
                            <a href="orcamento-personalizado.html" class="btn btn-light btn-lg">
                                <i class="fas fa-wrench me-2"></i>Solicitar Orçamento Personalizado
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contador de Resultados -->
            <div class="row mb-3">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <p class="mb-0 text-muted">
                            <span id="contadorResultados">0</span> produto(s) encontrado(s)
                        </p>
                        <button class="btn btn-sm btn-outline-secondary" id="btnColapsarFiltros" type="button" data-bs-toggle="collapse" data-bs-target="#filtrosContainer" aria-expanded="true">
                            <i class="fas fa-chevron-up me-2"></i>Ocultar Filtros
                        </button>
                    </div>
                </div>
            </div>

            <!-- Filtros de Produtos -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="collapse show" id="filtrosContainer">
                        <h5 class="mb-3 fw-bold text-center">
                            <i class="fas fa-filter me-2"></i>Filtrar Produtos
                        </h5>
                    
                    <!-- Filtro por Categoria -->
                    <div class="mb-3">
                        <label class="form-label fw-bold mb-2 d-block text-center">
                            <i class="fas fa-tags me-2"></i>Categoria:
                        </label>
                        <div class="d-flex flex-wrap gap-2 align-items-center justify-content-center">
                            <button class="btn btn-outline-primary active filter-btn" data-filter-type="category" data-filter="all">
                                <i class="fas fa-th me-2"></i> Todos
                                <span class="badge bg-primary ms-2 filter-count" data-filter-type="category" data-filter="all">-</span>
                            </button>
                            <button class="btn btn-outline-primary filter-btn" data-filter-type="category" data-filter="autotransformadores">
                                <i class="fas fa-exchange-alt me-2"></i> <span class="d-none d-lg-inline">Autotransformadores</span><span class="d-lg-none">Auto</span>
                                <span class="badge bg-secondary ms-2 filter-count" data-filter-type="category" data-filter="autotransformadores">-</span>
                            </button>
                            <button class="btn btn-outline-primary filter-btn" data-filter-type="category" data-filter="transformadores-isoladores">
                                <i class="fas fa-shield-alt me-2"></i> <span class="d-none d-lg-inline">Transformadores Isoladores</span><span class="d-lg-none">Isoladores</span>
                                <span class="badge bg-secondary ms-2 filter-count" data-filter-type="category" data-filter="transformadores-isoladores">-</span>
                            </button>
                            <button class="btn btn-outline-primary filter-btn" data-filter-type="category" data-filter="transformadores-oleo">
                                <i class="fas fa-oil-can me-2"></i> <span class="d-none d-lg-inline">Transformadores a Óleo</span><span class="d-lg-none">Óleo</span>
                                <span class="badge bg-secondary ms-2 filter-count" data-filter-type="category" data-filter="transformadores-oleo">-</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filtro por Tipo de Refrigeração -->
                    <div class="mb-3">
                        <label class="form-label fw-bold mb-2 d-block text-center">
                            <i class="fas fa-fan me-2"></i>Tipo de Refrigeração:
                        </label>
                        <div class="d-flex flex-wrap gap-2 justify-content-center">
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="refrigeracao" data-filter="all">
                                Todos
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="refrigeracao" data-filter="oleo">
                                <i class="fas fa-oil-can me-2"></i> A Óleo
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="refrigeracao" data-filter="seco">
                                <i class="fas fa-wind me-2"></i> A Seco
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="refrigeracao" data-filter="ar-natural">
                                <i class="fas fa-air-freshener me-2"></i> Ar Natural
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filtro por Tipo de Construção -->
                    <div class="mb-3">
                        <label class="form-label fw-bold mb-2 d-block text-center">
                            <i class="fas fa-cog me-2"></i>Tipo de Construção:
                        </label>
                        <div class="d-flex flex-wrap gap-2 justify-content-center">
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="construcao" data-filter="all">
                                Todos
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="construcao" data-filter="monofasico">
                                Monofásico
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="construcao" data-filter="bifasico">
                                Bifásico
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="construcao" data-filter="trifasico">
                                Trifásico
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filtro por Potência -->
                    <div class="mb-3">
                        <label class="form-label fw-bold mb-2 d-block text-center">
                            <i class="fas fa-bolt me-2"></i>Potência (kVA):
                        </label>
                        <div class="d-flex flex-wrap gap-2 justify-content-center">
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="potencia" data-filter="all">
                                Todos
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="potencia" data-filter="ate-50">
                                Até 50 kVA
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="potencia" data-filter="50-150">
                                50 - 150 kVA
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="potencia" data-filter="acima-150">
                                Acima de 150 kVA
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filtro por Uso -->
                    <div class="mb-3">
                        <label class="form-label fw-bold mb-2 d-block text-center">
                            <i class="fas fa-building me-2"></i>Uso:
                        </label>
                        <div class="d-flex flex-wrap gap-2 justify-content-center">
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="uso" data-filter="all">
                                Todos
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="uso" data-filter="interno">
                                <i class="fas fa-home me-2"></i> Interno
                            </button>
                            <button class="btn btn-outline-secondary filter-btn" data-filter-type="uso" data-filter="externo">
                                <i class="fas fa-cloud-sun me-2"></i> Externo
                            </button>
                        </div>
                    </div>
                    
                        <!-- Botão Limpar Filtros -->
                        <div class="text-center mt-3 pt-3 border-top">
                            <button class="btn btn-outline-danger" id="btnLimparFiltros">
                                <i class="fas fa-times me-2"></i> Limpar Todos os Filtros
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Grid de Produtos -->
            <div class="row g-4" id="loja-produtos">
                <!-- Produtos removidos - container vazio -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer bg-dark text-white pt-5 pb-0">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                    <div class="footer-logo mb-3">
                        <img src="src/imgs/WhatsApp Image 2026-01-07 at 07.40.38 1.svg" alt="USETRAFO - Logo" class="img-fluid" style="max-height: 80px;" loading="lazy">
                    </div>
                    <p class="footer-text">Transformadores elétricos de alta qualidade há mais de 30 anos.</p>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="footer-links">
                        <h5 class="footer-title mb-3">Links Rápidos</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <a href="index.html#sobre" class="footer-link-item">
                                    <i class="fas fa-chevron-right me-2"></i> Sobre Nós
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="index.html#produtos" class="footer-link-item">
                                    <i class="fas fa-chevron-right me-2"></i> Produtos
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="loja.html" class="footer-link-item">
                                    <i class="fas fa-chevron-right me-2"></i> Loja
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="calculadora.html" class="footer-link-item">
                                    <i class="fas fa-chevron-right me-2"></i> Calculadora
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="index.html#contato" class="footer-link-item">
                                    <i class="fas fa-chevron-right me-2"></i> Contato
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="footer-contact">
                        <h5 class="footer-title mb-3">Contato</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <i class="fas fa-phone me-2"></i>
                                <a href="tel:1140384800" class="footer-link">(11) 4038-4800</a>
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-envelope me-2"></i>
                                <a href="mailto:contato@usetrafo.com.br" class="footer-link">contato@usetrafo.com.br</a>
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-map-marker-alt me-2"></i>
                                <span class="footer-text">Varzea Paulista - SP</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="footer-info">
                        <h5 class="footer-title mb-3">Informações</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <i class="fas fa-clock me-2"></i>
                                <span class="footer-text">Segunda a Sexta: 8h às 17h</span>
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-shield-alt me-2"></i>
                                <span class="footer-text">Garantia de 36 meses</span>
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-certificate me-2"></i>
                                <span class="footer-text">Produtos certificados</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6 mb-3 mb-md-0">
                        <p class="mb-0 footer-copyright">
                            <i class="fas fa-copyright me-2"></i>
                            2025 USETRAFO. Todos os direitos reservados.
                        </p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p class="mb-0 footer-developer">
                            Desenvolvido por<span style="margin: 0 0.5rem;"></span>
                            <a href="https://brianws01.github.io/WoodCompany/" target="_blank" rel="noopener noreferrer" class="footer-dev-link">
                                <i class="fas fa-code me-1"></i> WoodTec Company
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modais dos Produtos -->
    <!-- Nota: Os modais completos devem ser copiados do index.html. Os botões "Comprar na nossa loja" nos modais devem adicionar ao carrinho automaticamente. -->

    <!-- Modal de Login -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">
                        <i class="fas fa-sign-in-alt me-2"></i>Entrar na sua conta
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">E-mail</label>
                            <input type="email" class="form-control" id="loginEmail" required aria-required="true" aria-describedby="loginEmailHelp">
                            <div id="loginEmailHelp" class="form-text">Digite seu e-mail cadastrado</div>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Senha</label>
                            <input type="password" class="form-control" id="loginPassword" required aria-required="true">
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">
                                Lembrar-me
                            </label>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt me-2"></i>Entrar
                            </button>
                        </div>
                    </form>
                    <div class="text-center mt-3">
                        <p class="mb-0">Não tem uma conta? <a href="registro.html">Crie uma aqui</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Registro -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered register-modal-dialog">
            <div class="modal-content register-modal-content">
                <div class="modal-header register-modal-header">
                    <h5 class="modal-title" id="registerModalLabel">
                        <i class="fas fa-user-plus me-2"></i>Criar nova conta
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body register-modal-body">
                    <form id="registerForm">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="registerName" class="form-label">Nome Completo</label>
                                <input type="text" class="form-control form-control-sm" id="registerName" required aria-required="true">
                            </div>
                            <div class="col-md-6">
                                <label for="registerEmail" class="form-label">E-mail</label>
                                <input type="email" class="form-control form-control-sm" id="registerEmail" required aria-required="true" aria-describedby="registerEmailHelp">
                                <div id="registerEmailHelp" class="form-text small">Usaremos este e-mail para entrar na sua conta</div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="registerPhone" class="form-label">Telefone</label>
                            <input type="tel" class="form-control form-control-sm" id="registerPhone" placeholder="(00) 00000-0000" required aria-required="true">
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="registerPassword" class="form-label">Senha</label>
                                <input type="password" class="form-control form-control-sm" id="registerPassword" required aria-required="true" aria-describedby="registerPasswordHelp" minlength="6">
                                <div id="registerPasswordHelp" class="form-text small">Mínimo de 6 caracteres</div>
                            </div>
                            <div class="col-md-6">
                                <label for="registerPasswordConfirm" class="form-label">Confirmar Senha</label>
                                <input type="password" class="form-control form-control-sm" id="registerPasswordConfirm" required aria-required="true">
                            </div>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="acceptTerms" required aria-required="true">
                            <label class="form-check-label small" for="acceptTerms">
                                Aceito os <a href="#" target="_blank">termos de uso</a> e <a href="#" target="_blank">política de privacidade</a>
                            </label>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-sm">
                                <i class="fas fa-user-plus me-2"></i>Criar Conta
                            </button>
                        </div>
                    </form>
                    <div class="text-center mt-3">
                        <p class="mb-0 small">Já tem uma conta? <a href="login.html">Entre aqui</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Login Necessário -->
    <div class="modal fade" id="loginRequiredModal" tabindex="-1" aria-labelledby="loginRequiredModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginRequiredModalLabel">
                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>Login Necessário
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body text-center">
                    <i class="fas fa-lock fa-3x text-primary mb-3"></i>
                    <p class="lead">Você precisa estar logado para realizar uma compra.</p>
                    <p>Faça login ou crie uma conta para continuar.</p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <a href="login.html" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt me-2"></i>Fazer Login
                    </a>
                    <a href="registro.html" class="btn btn-outline-primary">
                        <i class="fas fa-user-plus me-2"></i>Criar Conta
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script>
        // Inicializar cliente Supabase
        if (typeof SUPABASE_URL !== 'undefined' && typeof SUPABASE_ANON_KEY !== 'undefined' && 
            SUPABASE_URL !== 'COLE_SUA_PROJECT_URL_AQUI' && SUPABASE_ANON_KEY !== 'COLE_SUA_ANON_KEY_AQUI') {
            window.supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        }
    </script>
    
    <!-- Custom JS -->
    <script src="script.js"></script>
    
    <!-- Script específico da loja -->
    <script>
        // Função de notificação global (fallback se authManager não estiver disponível)
        function showNotification(message, type = 'info', duration = 4000) {
            let container = document.getElementById('notificationContainer');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notificationContainer';
                container.className = 'notification-container';
                document.body.appendChild(container);
            }
            
            let icon = 'fa-info-circle';
            let title = 'Informação';
            
            switch(type) {
                case 'success':
                    icon = 'fa-check-circle';
                    title = 'Sucesso!';
                    break;
                case 'error':
                case 'danger':
                    icon = 'fa-exclamation-circle';
                    title = 'Erro!';
                    break;
                case 'warning':
                    icon = 'fa-exclamation-triangle';
                    title = 'Atenção!';
                    break;
            }
            
            const notification = document.createElement('div');
            notification.className = `notification ${type} progress`;
            notification.innerHTML = `
                <div class="notification-header">
                    <div class="notification-icon">
                        <i class="fas ${icon}"></i>
                    </div>
                    <div class="notification-content">
                        <div class="notification-title">${title}</div>
                    </div>
                    <button class="notification-close" aria-label="Fechar">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="notification-body">
                    <p class="notification-message">${message}</p>
                </div>
                <div class="notification-progress-bar" style="animation-duration: ${duration}ms;"></div>
            `;
            
            container.appendChild(notification);
            
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                notification.classList.add('hiding');
                setTimeout(() => notification.remove(), 300);
            });
            
            setTimeout(() => {
                notification.classList.add('hiding');
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }
        
        // Sistema de Filtros Avançado Melhorado - Permite múltiplas seleções (até 2 por categoria)
        const filtrosAtivos = {
            category: [],
            refrigeracao: [],
            construcao: [],
            potencia: [],
            uso: [],
            busca: ''
        };
        
        // Debounce para busca
        // Função debounce já está disponível em script.js
        
        // Inicializar filtros
        document.addEventListener('DOMContentLoaded', function() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            const lojaItems = document.querySelectorAll('.loja-item');
            const btnLimparFiltros = document.getElementById('btnLimparFiltros');
            const contadorResultados = document.getElementById('contadorResultados');
            const btnColapsarFiltros = document.getElementById('btnColapsarFiltros');
            
            if (filterButtons.length === 0) {
                console.error('ERRO: Nenhum botão de filtro foi encontrado!');
                return;
            }
            
            // Atualizar contadores de filtros
            function atualizarContadoresFiltros() {
                const filterCounts = {};
                
                // Contar produtos por filtro
                filterButtons.forEach(btn => {
                    const filterType = btn.getAttribute('data-filter-type');
                    const filterValue = btn.getAttribute('data-filter');
                    const key = `${filterType}-${filterValue}`;
                    
                    if (!filterCounts[key]) {
                        filterCounts[key] = 0;
                    }
                    
                    // Contar produtos que correspondem a este filtro específico
                    lojaItems.forEach(item => {
                        const itemValue = item.getAttribute(`data-${filterType}`);
                        if (itemValue === filterValue || filterValue === 'all') {
                            filterCounts[key]++;
                        }
                    });
                });
                
                // Atualizar badges
                document.querySelectorAll('.filter-count').forEach(badge => {
                    const filterType = badge.getAttribute('data-filter-type');
                    const filterValue = badge.getAttribute('data-filter');
                    const key = `${filterType}-${filterValue}`;
                    const count = filterCounts[key] || 0;
                    badge.textContent = count;
                    badge.style.display = filterValue === 'all' ? 'none' : 'inline-block';
                });
            }
            
            // Inicializar com todos os produtos visíveis (sem filtros)
            function inicializarFiltros() {
                // Deixar arrays vazios para mostrar todos os produtos
                filtrosAtivos.category = [];
                filtrosAtivos.refrigeracao = [];
                filtrosAtivos.construcao = [];
                filtrosAtivos.potencia = [];
                filtrosAtivos.uso = [];
            }
            
            // Função para aplicar filtros
            function aplicarFiltros() {
                let itensVisiveis = [];
                const termoBusca = filtrosAtivos.busca.toLowerCase().trim();
                
                lojaItems.forEach(item => {
                    let mostrar = true;
                    
                    // Verificar filtros de atributos (múltiplas seleções)
                    Object.keys(filtrosAtivos).forEach(tipo => {
                        if (tipo === 'busca' || tipo === 'ordenacao') return;
                        
                        const filtrosSelecionados = filtrosAtivos[tipo];
                        
                        // Se não há filtros selecionados ou está vazio, não filtrar por esta categoria
                        if (!Array.isArray(filtrosSelecionados) || filtrosSelecionados.length === 0) {
                            return; // Não filtrar por esta categoria - mostrar todos
                        }
                        
                        // Verificar se o item corresponde a algum dos filtros selecionados
                        const valorItem = item.getAttribute(`data-${tipo}`);
                        
                        // Se tem "all" na lista, mostrar todos (não filtrar)
                        if (filtrosSelecionados.includes('all')) {
                            return; // Não filtrar por esta categoria
                        }
                        
                        // Verificar se corresponde a algum dos filtros selecionados
                        const corresponde = filtrosSelecionados.includes(valorItem);
                        
                        if (!corresponde) {
                            mostrar = false;
                        }
                    });
                    
                    // Verificar busca por texto
                    if (mostrar && termoBusca) {
                        const nome = item.querySelector('.card-title')?.textContent.toLowerCase() || '';
                        const descricao = item.querySelector('.card-text')?.textContent.toLowerCase() || '';
                        const categoria = item.getAttribute('data-category') || '';
                        
                        if (!nome.includes(termoBusca) && 
                            !descricao.includes(termoBusca) && 
                            !categoria.includes(termoBusca)) {
                            mostrar = false;
                        }
                    }
                    
                    // Aplicar visibilidade
                    if (mostrar) {
                        item.style.display = '';
                        item.classList.remove('d-none');
                        itensVisiveis.push(item);
                    } else {
                        item.style.display = 'none';
                        item.classList.add('d-none');
                    }
                });
                
                // Atualizar contador
                contadorResultados.textContent = itensVisiveis.length;
                
                // Mostrar mensagem se não houver resultados
                const produtosContainer = document.getElementById('loja-produtos');
                let mensagemVazia = produtosContainer.querySelector('.no-results');
                
                if (itensVisiveis.length === 0) {
                    if (!mensagemVazia) {
                        mensagemVazia = document.createElement('div');
                        mensagemVazia.className = 'col-12 no-results text-center py-5';
                        mensagemVazia.innerHTML = `
                            <i class="fas fa-search fa-3x text-muted mb-3"></i>
                            <h4 class="text-muted">Nenhum produto encontrado</h4>
                            <p class="text-muted">Tente ajustar os filtros ou busca para encontrar o que procura.</p>
                            <button class="btn btn-primary mt-3" id="btnLimparFiltrosMsg">
                                <i class="fas fa-times me-2"></i> Limpar Filtros
                            </button>
                        `;
                        produtosContainer.appendChild(mensagemVazia);
                        
                        // Adicionar listener ao botão da mensagem
                        const btnLimparMsg = document.getElementById('btnLimparFiltrosMsg');
                        if (btnLimparMsg) {
                            btnLimparMsg.addEventListener('click', function(e) {
                                limparTodosFiltros(e);
                            });
                        }
                    }
                } else {
                    if (mensagemVazia) {
                        mensagemVazia.remove();
                    }
                }
                
                // Animação suave ao filtrar
                itensVisiveis.forEach((item, index) => {
                    setTimeout(() => {
                        item.style.opacity = '0';
                        item.style.transform = 'translateY(20px)';
                        item.style.transition = 'all 0.3s ease';
                        
                        setTimeout(() => {
                            item.style.opacity = '1';
                            item.style.transform = 'translateY(0)';
                        }, 50);
                    }, index * 30);
                });
            }
            
            // Adicionar listeners aos botões de filtro
            filterButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const filterType = this.getAttribute('data-filter-type');
                    const filterValue = this.getAttribute('data-filter');
                    
                    // Garantir que o array existe
                    if (!Array.isArray(filtrosAtivos[filterType])) {
                        filtrosAtivos[filterType] = [];
                    }
                    
                    // Obter array atual
                    let filtrosCategoria = filtrosAtivos[filterType].slice(); // Cópia do array
                    
                    // Se clicou em "all"
                    if (filterValue === 'all') {
                        // Se "all" já está selecionado, desmarcar tudo
                        if (filtrosCategoria.includes('all')) {
                            filtrosCategoria = [];
                        } else {
                            // Selecionar apenas "all"
                            filtrosCategoria = ['all'];
                        }
                    } else {
                        // NÃO é "all" - lógica de múltiplas seleções
                        
                        // Verificar se já está selecionado
                        const jaEstaSelecionado = filtrosCategoria.includes(filterValue);
                        
                        if (jaEstaSelecionado) {
                            // REMOVER da seleção
                            const index = filtrosCategoria.indexOf(filterValue);
                            filtrosCategoria.splice(index, 1);
                            
                            // Remover "all" se estiver na lista
                            const allIndex = filtrosCategoria.indexOf('all');
                            if (allIndex > -1) {
                                filtrosCategoria.splice(allIndex, 1);
                            }
                        } else {
                            // ADICIONAR à seleção
                            
                            // Remover "all" se estiver na lista
                            const allIndex = filtrosCategoria.indexOf('all');
                            if (allIndex > -1) {
                                filtrosCategoria.splice(allIndex, 1);
                            }
                            
                            // Contar filtros que não são "all"
                            const filtrosSemAll = filtrosCategoria.filter(f => f !== 'all');
                            
                            if (filtrosSemAll.length < 2) {
                                // Adicionar o novo filtro
                                filtrosCategoria.push(filterValue);
                            } else {
                                // Já tem 2 selecionados
                                if (window.authManager) {
                                    window.authManager.showAlert('Você pode selecionar no máximo 2 filtros por categoria', 'warning');
                                } else {
                                    showNotification('Você pode selecionar no máximo 2 filtros por categoria', 'warning');
                                }
                                return;
                            }
                        }
                    }
                    
                    // ATUALIZAR o array no objeto filtrosAtivos
                    filtrosAtivos[filterType] = filtrosCategoria;
                    
                    // SINCRONIZAR estado visual de TODOS os botões desta categoria
                    const todosBotoesCategoria = document.querySelectorAll(`[data-filter-type="${filterType}"]`);
                    
                    todosBotoesCategoria.forEach(btn => {
                        const btnValue = btn.getAttribute('data-filter');
                        const deveEstarAtivo = filtrosCategoria.includes(btnValue);
                        
                        // Remover todas as classes relacionadas primeiro
                        btn.classList.remove('active', 'btn-primary', 'btn-outline-primary', 'btn-outline-secondary');
                        
                        // Aplicar estado correto - FORÇAR aplicação das classes
                        if (deveEstarAtivo) {
                            // ATIVAR
                            btn.classList.add('active');
                            btn.classList.add('btn-primary');
                            btn.classList.remove('btn-outline-primary', 'btn-outline-secondary');
                            // Forçar estilo inline para garantir
                            btn.style.setProperty('background-color', 'var(--primary-color)', 'important');
                            btn.style.setProperty('color', '#ffffff', 'important');
                            btn.style.setProperty('border-color', 'var(--primary-color)', 'important');
                        } else {
                            // DESATIVAR
                            btn.classList.remove('active', 'btn-primary');
                            if (filterType === 'category') {
                                btn.classList.add('btn-outline-primary');
                            } else {
                                btn.classList.add('btn-outline-secondary');
                            }
                            // Limpar estilos inline
                            btn.style.removeProperty('background-color');
                            btn.style.removeProperty('color');
                            btn.style.removeProperty('border-color');
                        }
                    });
                    
                    // Aplicar filtros
                    aplicarFiltros();
                });
            });
            
            // Função para limpar todos os filtros
            function limparTodosFiltros(e) {
                if (e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                console.log('Função limparTodosFiltros chamada!');
                
                // Resetar filtros para arrays vazios
                filtrosAtivos.category = [];
                filtrosAtivos.refrigeracao = [];
                filtrosAtivos.construcao = [];
                filtrosAtivos.potencia = [];
                filtrosAtivos.uso = [];
                filtrosAtivos.busca = '';
                
                console.log('Filtros resetados:', filtrosAtivos);
                
                // Resetar todos os botões visualmente
                const todosBotoes = document.querySelectorAll('.filter-btn');
                console.log('Total de botões para resetar:', todosBotoes.length);
                
                todosBotoes.forEach(btn => {
                    // Remover todas as classes relacionadas
                    btn.classList.remove('active', 'btn-primary', 'btn-outline-primary', 'btn-outline-secondary');
                    
                    // Remover estilos inline que foram adicionados
                    btn.style.removeProperty('background-color');
                    btn.style.removeProperty('color');
                    btn.style.removeProperty('border-color');
                    
                    // Adicionar classe outline apropriada
                    const filterType = btn.getAttribute('data-filter-type');
                    if (filterType === 'category') {
                        btn.classList.add('btn-outline-primary');
                    } else {
                        btn.classList.add('btn-outline-secondary');
                    }
                });
                
                // Limpar campo de busca se existir
                const buscaInput = document.getElementById('buscaInput');
                if (buscaInput) {
                    buscaInput.value = '';
                }
                
                // Aplicar filtros (mostrar todos os produtos)
                aplicarFiltros();
                
                // Atualizar contadores
                atualizarContadoresFiltros();
                
                console.log('Limpeza de filtros concluída!');
            }
            
            // Botão limpar filtros - adicionar listener de forma mais robusta
            if (btnLimparFiltros) {
                btnLimparFiltros.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Botão Limpar Filtros clicado!');
                    limparTodosFiltros(e);
                });
            } else {
                console.error('ERRO: Botão btnLimparFiltros não encontrado!');
            }
            
            // Botão colapsar filtros
            if (btnColapsarFiltros) {
                btnColapsarFiltros.addEventListener('click', function() {
                    const icon = this.querySelector('i');
                    const isExpanded = document.getElementById('filtrosContainer').classList.contains('show');
                    
                    if (isExpanded) {
                        icon.classList.remove('fa-chevron-up');
                        icon.classList.add('fa-chevron-down');
                        this.innerHTML = '<i class="fas fa-chevron-down me-2"></i>Mostrar Filtros';
                    } else {
                        icon.classList.remove('fa-chevron-down');
                        icon.classList.add('fa-chevron-up');
                        this.innerHTML = '<i class="fas fa-chevron-up me-2"></i>Ocultar Filtros';
                    }
                });
            }
            
            // Inicializar filtros
            inicializarFiltros();
            
            // Sincronizar estado visual inicial de TODOS os botões com os arrays vazios
            filterButtons.forEach(btn => {
                const filterType = btn.getAttribute('data-filter-type');
                const filterValue = btn.getAttribute('data-filter');
                const filtrosCategoria = filtrosAtivos[filterType] || [];
                const deveEstarAtivo = filtrosCategoria.includes(filterValue);
                
                // Remover todas as classes relacionadas
                btn.classList.remove('active', 'btn-primary', 'btn-outline-primary', 'btn-outline-secondary');
                
                // Aplicar estado correto baseado no array
                if (deveEstarAtivo) {
                    btn.classList.add('active', 'btn-primary');
                } else {
                    if (filterType === 'category') {
                        btn.classList.add('btn-outline-primary');
                    } else {
                        btn.classList.add('btn-outline-secondary');
                    }
                }
            });
            
            // Atualizar contadores e aplicar filtros iniciais
            atualizarContadoresFiltros();
            aplicarFiltros();
        });
        
        // Carrinho de compras
        let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
        
        // Elementos do DOM
        const btnCarrinho = document.getElementById('btnCarrinho');
        const carrinhoSidebar = document.getElementById('carrinhoSidebar');
        const carrinhoOverlay = document.getElementById('carrinhoOverlay');
        const btnFecharCarrinho = document.getElementById('btnFecharCarrinho');
        const carrinhoItens = document.getElementById('carrinhoItens');
        const carrinhoTotal = document.getElementById('carrinhoTotal');
        const carrinhoBadge = document.getElementById('carrinhoBadge');
        const btnFinalizarCompra = document.getElementById('btnFinalizarCompra');
        const btnLimparCarrinho = document.getElementById('btnLimparCarrinho');
        
        // Abrir/fechar carrinho
        btnCarrinho.addEventListener('click', () => {
            carrinhoSidebar.classList.add('active');
            carrinhoOverlay.classList.add('active');
        });
        
        btnFecharCarrinho.addEventListener('click', fecharCarrinho);
        carrinhoOverlay.addEventListener('click', fecharCarrinho);
        
        function fecharCarrinho() {
            carrinhoSidebar.classList.remove('active');
            carrinhoOverlay.classList.remove('active');
        }
        
        // Adicionar ao carrinho
        document.querySelectorAll('.btn-adicionar-carrinho').forEach(btn => {
            btn.addEventListener('click', function() {
                const product = this.getAttribute('data-product');
                const name = this.getAttribute('data-name');
                const price = parseFloat(this.getAttribute('data-price'));
                
                const item = carrinho.find(i => i.product === product);
                if (item) {
                    item.quantity++;
                } else {
                    carrinho.push({ product, name, price, quantity: 1 });
                }
                
                salvarCarrinho();
                atualizarCarrinho();
                fecharCarrinho();
                
                // Feedback visual
                this.innerHTML = '<i class="fas fa-check me-2"></i> Adicionado!';
                this.classList.add('btn-success');
                setTimeout(() => {
                    this.innerHTML = '<i class="fas fa-shopping-cart me-2"></i> Adicionar ao Carrinho';
                    this.classList.remove('btn-success');
                }, 2000);
            });
        });
        
        // Atualizar carrinho
        function atualizarCarrinho() {
            if (carrinho.length === 0) {
                carrinhoItens.innerHTML = '<p class="text-muted text-center">Seu carrinho está vazio</p>';
                carrinhoTotal.textContent = 'R$ 0,00';
                carrinhoBadge.textContent = '0';
                return;
            }
            
            carrinhoItens.innerHTML = carrinho.map((item, index) => `
                <div class="carrinho-item">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                            <h6 class="mb-1">${item.name}</h6>
                            <small class="text-muted">R$ ${item.price.toFixed(2).replace('.', ',')}</small>
                        </div>
                        <button class="btn btn-sm btn-outline-danger btn-remover-item" data-index="${index}">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="d-flex align-items-center">
                        <button class="btn btn-sm btn-outline-secondary btn-diminuir" data-index="${index}">-</button>
                        <span class="mx-3">${item.quantity}</span>
                        <button class="btn btn-sm btn-outline-secondary btn-aumentar" data-index="${index}">+</button>
                        <span class="ms-auto fw-bold">R$ ${(item.price * item.quantity).toFixed(2).replace('.', ',')}</span>
                    </div>
                </div>
            `).join('');
            
            const total = carrinho.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            carrinhoTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
            carrinhoBadge.textContent = carrinho.reduce((sum, item) => sum + item.quantity, 0);
            
            // Event listeners para remover e alterar quantidade
            document.querySelectorAll('.btn-remover-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    carrinho.splice(index, 1);
                    salvarCarrinho();
                    atualizarCarrinho();
                });
            });
            
            document.querySelectorAll('.btn-diminuir').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    if (carrinho[index].quantity > 1) {
                        carrinho[index].quantity--;
                        salvarCarrinho();
                        atualizarCarrinho();
                    }
                });
            });
            
            document.querySelectorAll('.btn-aumentar').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    carrinho[index].quantity++;
                    salvarCarrinho();
                    atualizarCarrinho();
                });
            });
        }
        
        // Salvar carrinho no localStorage
        function salvarCarrinho() {
            localStorage.setItem('carrinho', JSON.stringify(carrinho));
        }
        
        // Limpar carrinho
        btnLimparCarrinho.addEventListener('click', () => {
            const confirmModal = document.createElement('div');
            confirmModal.className = 'modal fade';
            confirmModal.setAttribute('tabindex', '-1');
            confirmModal.innerHTML = `
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-trash-alt me-2"></i>Limpar Carrinho
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body text-center">
                            <i class="fas fa-shopping-cart fa-3x text-warning mb-3"></i>
                            <p class="lead">Deseja realmente limpar todo o carrinho?</p>
                        </div>
                        <div class="modal-footer justify-content-center">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="button" class="btn btn-danger" id="confirmClearCart">
                                <i class="fas fa-trash-alt me-2"></i>Limpar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmModal);
            
            const bsModal = new bootstrap.Modal(confirmModal);
            bsModal.show();
            
            document.getElementById('confirmClearCart').addEventListener('click', () => {
                carrinho = [];
                salvarCarrinho();
                atualizarCarrinho();
                bsModal.hide();
                setTimeout(() => confirmModal.remove(), 300);
                
                if (window.authManager) {
                    window.authManager.showAlert('Carrinho limpo com sucesso!', 'success');
                } else {
                    showNotification('Carrinho limpo com sucesso!', 'success');
                }
            });
            
            confirmModal.addEventListener('hidden.bs.modal', () => {
                confirmModal.remove();
            });
        });
        
        // Finalizar compra - Abrir modal de orçamento
        btnFinalizarCompra.addEventListener('click', () => {
            if (carrinho.length === 0) {
                if (window.authManager) {
                    window.authManager.showAlert('Seu carrinho está vazio!', 'warning');
                } else {
                    showNotification('Seu carrinho está vazio!', 'warning');
                }
                return;
            }
            
            // Abrir modal de orçamento
            const orcamentoModal = new bootstrap.Modal(document.getElementById('orcamentoModal'));
            orcamentoModal.show();
        });
        
        // Inicializar carrinho
        atualizarCarrinho();

        // As funções da calculadora foram movidas para calculadora.html
        // Para usar a calculadora, acesse: calculadora.html
    </script>

    <!-- Modal de Orçamento -->
    <div class="modal fade" id="orcamentoModal" tabindex="-1" aria-labelledby="orcamentoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="orcamentoModalLabel">
                        <i class="fas fa-file-pdf me-2"></i>Solicitar Orçamento
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="orcamentoForm">
                        <!-- Dados do Cliente -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><i class="fas fa-building me-2"></i>Dados do Cliente</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="orcamentoNome" class="form-label">Nome <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="orcamentoNome" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="orcamentoCNPJ" class="form-label">CNPJ <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="orcamentoCNPJ" placeholder="00.000.000/0000-00" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="orcamentoTelefone" class="form-label">Telefone <span class="text-danger">*</span></label>
                                        <input type="tel" class="form-control" id="orcamentoTelefone" placeholder="(00) 00000-0000" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="orcamentoEmail" class="form-label">E-mail <span class="text-danger">*</span></label>
                                        <input type="email" class="form-control" id="orcamentoEmail" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Condições Comerciais -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><i class="fas fa-handshake me-2"></i>Condições Comerciais</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="orcamentoPagamento" class="form-label">Forma de Pagamento <span class="text-danger">*</span></label>
                                        <select class="form-select" id="orcamentoPagamento" required>
                                            <option value="">Selecione...</option>
                                            <option value="A Vista">À Vista</option>
                                            <option value="2 Parcelas (30/60 Dias)">2 Parcelas (30/60 Dias)</option>
                                            <option value="3 Parcelas (30/60/90 Dias)">3 Parcelas (30/60/90 Dias)</option>
                                            <option value="Boleto">Boleto</option>
                                            <option value="Cartão de Crédito">Cartão de Crédito</option>
                                            <option value="BNDES">BNDES</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="orcamentoFrete" class="form-label">Frete <span class="text-danger">*</span></label>
                                        <select class="form-select" id="orcamentoFrete" required>
                                            <option value="">Selecione...</option>
                                            <option value="Por conta do emitente CIF (Sem Descarga)">Por conta do emitente CIF (Sem Descarga)</option>
                                            <option value="Por conta do destinatário FOB">Por conta do destinatário FOB</option>
                                            <option value="A combinar">A combinar</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="orcamentoValidade" class="form-label">Validade da Proposta (dias) <span class="text-danger">*</span></label>
                                        <input type="number" class="form-control" id="orcamentoValidade" value="30" min="1" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="orcamentoPrazoFabricacao" class="form-label">Prazo de Fabricação (dias úteis) <span class="text-danger">*</span></label>
                                        <input type="number" class="form-control" id="orcamentoPrazoFabricacao" value="3" min="1" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Resumo do Carrinho -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><i class="fas fa-shopping-cart me-2"></i>Itens do Orçamento</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered" id="orcamentoItensTable">
                                        <thead class="table-primary">
                                            <tr>
                                                <th>Item</th>
                                                <th>Descrição</th>
                                                <th>Quantidade</th>
                                                <th>Preço Unit.</th>
                                                <th>Preço Total</th>
                                            </tr>
                                        </thead>
                                        <tbody id="orcamentoItensBody">
                                            <!-- Itens serão inseridos aqui via JavaScript -->
                                        </tbody>
                                        <tfoot>
                                            <tr class="table-secondary">
                                                <th colspan="4" class="text-end">Total:</th>
                                                <th id="orcamentoTotal">R$ 0,00</th>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Observações -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><i class="fas fa-sticky-note me-2"></i>Observações</h6>
                            </div>
                            <div class="card-body">
                                <textarea class="form-control" id="orcamentoObservacoes" rows="3" placeholder="Informações adicionais, especificações técnicas, etc."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="btnGerarPDF">
                        <i class="fas fa-file-pdf me-2"></i>Gerar PDF do Orçamento
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // SISTEMA DE ORÇAMENTO E GERAÇÃO DE PDF
        // ============================================
        
        const orcamentoModal = document.getElementById('orcamentoModal');
        const orcamentoForm = document.getElementById('orcamentoForm');
        const btnGerarPDF = document.getElementById('btnGerarPDF');
        const orcamentoItensBody = document.getElementById('orcamentoItensBody');
        const orcamentoTotal = document.getElementById('orcamentoTotal');

        // Quando o modal de orçamento abrir, preencher com dados do carrinho
        if (orcamentoModal) {
            orcamentoModal.addEventListener('show.bs.modal', () => {
                atualizarItensOrcamento();
                preencherDadosDaCalculadora();
            });
        }
        
        // Verificar se veio da calculadora e abrir modal automaticamente
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const hash = window.location.hash;
            
            if (hash === '#orcamento' || urlParams.has('origem')) {
                // Preencher dados da calculadora se vierem
                if (urlParams.has('origem') && urlParams.get('origem').includes('calculadora')) {
                    preencherDadosDaCalculadora();
                    
                    // Adicionar item ao carrinho se necessário
                    const potencia = urlParams.get('potencia');
                    const tensaoPrimaria = urlParams.get('tensao_primaria');
                    const tensaoSecundaria = urlParams.get('tensao_secundaria');
                    const fase = urlParams.get('fase') || 'trifasico';
                    
                    if (potencia && tensaoPrimaria && tensaoSecundaria) {
                        const nomeProduto = `Transformador ${fase === 'trifasico' ? 'Trifásico' : 'Monofásico'} ${potencia}kVA ${tensaoPrimaria}V/${tensaoSecundaria}V`;
                        
                        // Verificar se já existe no carrinho
                        const carrinhoAtual = JSON.parse(localStorage.getItem('carrinho')) || [];
                        const existe = carrinhoAtual.find(item => item.name === nomeProduto);
                        
                        if (!existe && typeof carrinhoManager !== 'undefined') {
                            carrinhoManager.adicionarItem(
                                `calc-${Date.now()}`,
                                nomeProduto,
                                0,
                                ''
                            );
                        }
                    }
                }
                
                // Abrir modal após um pequeno delay para garantir que tudo está carregado
                setTimeout(() => {
                    const modal = new bootstrap.Modal(orcamentoModal);
                    modal.show();
                }, 500);
            }
        });
        
        // Função para preencher dados da calculadora no formulário de orçamento
        function preencherDadosDaCalculadora() {
            const urlParams = new URLSearchParams(window.location.search);
            
            if (!urlParams.has('origem') || !urlParams.get('origem').includes('calculadora')) {
                return;
            }
            
            const potencia = urlParams.get('potencia');
            const tensaoPrimaria = urlParams.get('tensao_primaria');
            const tensaoSecundaria = urlParams.get('tensao_secundaria');
            const frequencia = urlParams.get('frequencia') || '60';
            const fase = urlParams.get('fase') || 'trifasico';
            
            // Preencher dados do cliente se vierem da calculadora
            const nome = urlParams.get('nome');
            const cnpj = urlParams.get('cnpj');
            const telefone = urlParams.get('telefone');
            const email = urlParams.get('email');
            
            if (nome && document.getElementById('orcamentoNome')) {
                document.getElementById('orcamentoNome').value = nome;
            }
            if (cnpj && document.getElementById('orcamentoCNPJ')) {
                document.getElementById('orcamentoCNPJ').value = cnpj;
            }
            if (telefone && document.getElementById('orcamentoTelefone')) {
                document.getElementById('orcamentoTelefone').value = telefone;
            }
            if (email && document.getElementById('orcamentoEmail')) {
                document.getElementById('orcamentoEmail').value = email;
            }
            
            // Preencher campos se existirem
            if (potencia && document.getElementById('orcamentoObservacoes')) {
                const observacoes = document.getElementById('orcamentoObservacoes');
                let textoAtual = observacoes.value || '';
                
                const dadosCalculadora = `
DADOS DA CALCULADORA:
- Potência: ${potencia} kVA
- Tensão Primária: ${tensaoPrimaria} V
- Tensão Secundária: ${tensaoSecundaria} V
- Frequência: ${frequencia} Hz
- Tipo: ${fase === 'trifasico' ? 'Trifásico' : 'Monofásico'}
`;
                
                if (textoAtual && !textoAtual.includes('DADOS DA CALCULADORA')) {
                    observacoes.value = dadosCalculadora + '\n\n' + textoAtual;
                } else if (!textoAtual.includes('DADOS DA CALCULADORA')) {
                    observacoes.value = dadosCalculadora;
                }
            }
        }

        // Função para atualizar itens do orçamento
        function atualizarItensOrcamento() {
            const carrinhoAtual = JSON.parse(localStorage.getItem('carrinho')) || [];
            orcamentoItensBody.innerHTML = '';
            
            let total = 0;
            
            carrinhoAtual.forEach((item, index) => {
                const itemNumero = String(index + 1).padStart(5, '0');
                const precoUnit = item.price || 0;
                const quantidade = item.quantity || 1;
                const precoTotal = precoUnit * quantidade;
                total += precoTotal;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${itemNumero}</td>
                    <td>${item.name || 'Produto'}</td>
                    <td>
                        <input type="number" class="form-control form-control-sm" value="${quantidade}" min="1" 
                               onchange="atualizarPrecoOrcamento(${index}, this.value)" style="width: 80px;">
                    </td>
                    <td>
                        <input type="number" class="form-control form-control-sm preco-unitario" 
                               value="${precoUnit.toFixed(2)}" min="0" step="0.01"
                               onchange="atualizarPrecoOrcamento(${index}, null, this.value)" style="width: 120px;">
                    </td>
                    <td class="preco-total-item">R$ ${precoTotal.toFixed(2).replace('.', ',')}</td>
                `;
                orcamentoItensBody.appendChild(row);
            });
            
            orcamentoTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
        }

        // Função para atualizar preço quando quantidade ou preço unitário mudar
        window.atualizarPrecoOrcamento = function(index, quantidade, precoUnit) {
            const carrinhoAtual = JSON.parse(localStorage.getItem('carrinho')) || [];
            const item = carrinhoAtual[index];
            
            if (quantidade !== null) {
                item.quantity = parseInt(quantidade);
            }
            if (precoUnit !== null) {
                item.price = parseFloat(precoUnit);
            }
            
            const precoTotal = item.price * item.quantity;
            const row = event.target.closest('tr');
            row.querySelector('.preco-total-item').textContent = `R$ ${precoTotal.toFixed(2).replace('.', ',')}`;
            
            // Atualizar total
            let total = 0;
            carrinhoAtual.forEach(item => {
                total += (item.price || 0) * (item.quantity || 1);
            });
            orcamentoTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
        };

        // Máscaras para campos
        if (document.getElementById('orcamentoCNPJ')) {
            document.getElementById('orcamentoCNPJ').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length <= 14) {
                    value = value.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2}).*/, '$1.$2.$3/$4-$5');
                    e.target.value = value;
                }
            });
        }

        if (document.getElementById('orcamentoTelefone')) {
            document.getElementById('orcamentoTelefone').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length <= 11) {
                    value = value.replace(/^(\d{2})(\d{5})(\d{4}).*/, '($1) $2-$3');
                    if (value.length < 14) {
                        value = value.replace(/^(\d{2})(\d{4})(\d{4}).*/, '($1) $2-$3');
                    }
                    e.target.value = value;
                }
            });
        }

        // Gerar PDF do Orçamento
        if (btnGerarPDF) {
            btnGerarPDF.addEventListener('click', () => {
                if (!orcamentoForm.checkValidity()) {
                    orcamentoForm.reportValidity();
                    return;
                }
                
                gerarPDFOrcamento();
            });
        }

        // Função para gerar PDF usando o novo gerador
        async function gerarPDFOrcamento() {
            try {
                // Verificar se GeradorOrcamento está disponível
                if (!window.GeradorOrcamento) {
                    alert('Erro: Gerador de Orçamento não carregado. Recarregue a página.');
                    console.error('GeradorOrcamento não está disponível');
                    return;
                }
                
                const gerador = new window.GeradorOrcamento();
            
                // Coletar dados do formulário
                const dadosCliente = {
                    nome: document.getElementById('orcamentoNome').value,
                    cnpj: document.getElementById('orcamentoCNPJ').value,
                    telefone: document.getElementById('orcamentoTelefone').value,
                    email: document.getElementById('orcamentoEmail').value
                };
                
                const condicoes = {
                    pagamento: document.getElementById('orcamentoPagamento').value,
                    frete: document.getElementById('orcamentoFrete').value,
                    validade: document.getElementById('orcamentoValidade').value,
                    prazoFabricacao: document.getElementById('orcamentoPrazoFabricacao').value,
                    desconto: parseFloat(document.getElementById('orcamentoDesconto')?.value || 0),
                    seguro: parseFloat(document.getElementById('orcamentoSeguro')?.value || 0),
                    outros: parseFloat(document.getElementById('orcamentoOutros')?.value || 0)
                };
                
                const carrinhoAtual = JSON.parse(localStorage.getItem('carrinho')) || [];
                
                // Preparar dados para o gerador
                const dadosOrcamento = {
                    cliente: dadosCliente,
                    itens: carrinhoAtual,
                    condicoes: condicoes,
                    proposta: {
                        numero: gerador.gerarNumeroProposta(),
                        data: new Date()
                    },
                    vendedor: gerador.config.vendedor
                };
                
                // Gerar PDF
                const resultado = await gerador.gerarPDF(dadosOrcamento);
                
                // Fechar modal e mostrar mensagem
                const modal = bootstrap.Modal.getInstance(orcamentoModal);
                if (modal) modal.hide();
                
                if (window.authManager) {
                    window.authManager.showAlert('PDF do orçamento gerado com sucesso!', 'success');
                } else {
                    alert('PDF do orçamento gerado com sucesso!');
                }
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                alert('Erro ao gerar PDF: ' + error.message + '\n\nVerifique o console (F12) para mais detalhes.');
            }
        }
    </script>

    <!-- Script para criar usuário de teste (apenas em desenvolvimento) -->
    <script>
        // Criar usuário de teste automaticamente se não existir
        (function() {
            const usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];
            const usuarioTeste = usuarios.find(u => u.email === 'teste@usetrafo.com.br');
            
            if (!usuarioTeste) {
                const novoUsuario = {
                    nome: 'Usuário Teste',
                    email: 'teste@usetrafo.com.br',
                    senha: '123456',
                    telefone: '(11) 99999-9999',
                    dataCadastro: new Date().toISOString()
                };
                
                usuarios.push(novoUsuario);
                localStorage.setItem('usuarios', JSON.stringify(usuarios));
                console.log('✅ Usuário de teste criado automaticamente!');
                console.log('📋 E-mail: teste@usetrafo.com.br | Senha: 123456');
            }
        })();
    </script>

    <!-- Botão Flutuante WhatsApp -->
    <a href="https://wa.me/551140384800?text=Olá!%20Gostaria%20de%20solicitar%20um%20orçamento" 
       class="whatsapp-float" 
       target="_blank" 
       rel="noopener noreferrer"
       aria-label="Fale conosco no WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>
    <!-- Custom JS -->
    <script src="script.js"></script>
    <script src="api.js"></script>
    <script src="loja.js"></script>
</body>
</html>

